- name: Verificar Estado del Sitio
        id: check_status
        run: |
          # Añadimos -L para que siga el rastro hasta el destino final
          STATUS=$(curl -o /dev/null -s -L -w "%{http_code}\n" https://jotappe.com)
          echo "STATUS_CODE=$STATUS" >> $GITHUB_ENV
          
          # Ahora comparamos contra el código final
          if [ "$STATUS" -ne 200 ]; then
            echo "ALERT=TRUE" >> $GITHUB_ENV
          else
            echo "ALERT=FALSE" >> $GITHUB_ENV
          fi

      - name: Verificar Certificado SSL
        id: check_ssl
        run: |
          # Limpiamos la salida para que en Telegram solo veas la fecha
          EXPIRY=$(echo | openssl s_client -servername jotappe.com -connect jotappe.com:443 2>/dev/null | openssl x509 -noout -enddate | cut -d= -f2)
          echo "SSL_EXPIRY=$EXPIRY" >> $GITHUB_ENV
