<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Resultados Oficiales | Cochrane Patagonia Trail 2025</title>
    
    <link rel="stylesheet" href="https://cdn.datatables.net/1.13.6/css/jquery.dataTables.min.css">
    <link rel="stylesheet" href="https://cdn.datatables.net/responsive/2.5.0/css/responsive.dataTables.min.css">
    
    <style>
        :root { --accent: #8fbc8f; --bg-dark: #050505; --text-main: #ffffff; }
        * { box-sizing: border-box; }
        body { background: var(--bg-dark); font-family: 'Inter', system-ui, sans-serif; color: var(--text-main); margin: 0; padding: clamp(10px, 5vw, 20px); font-size: 14px; }
        .container { max-width: 1300px; margin: 0 auto; background: #111; padding: clamp(15px, 5vw, 25px); border-radius: 12px; border: 1px solid #333; }
        
        header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px; border-bottom: 1px solid #333; padding-bottom: 15px; }
        .logo { font-weight: 900; font-size: 24px; color: var(--accent); text-decoration: none; }
        .back-btn { color: #888; text-decoration: none; font-size: 12px; text-transform: uppercase; font-weight: bold; border: 1px solid #333; padding: 6px 12px; border-radius: 6px; }
        
        h1 { margin: 0 0 5px 0; font-size: clamp(1.4rem, 5vw, 1.8rem); color: #fff; }
        .subtitle { color: var(--accent); text-transform: uppercase; font-size: 0.7rem; letter-spacing: 2px; margin-bottom: 20px; display: block; font-weight: 800; }
        
        /* Banner de Evolución */
        .dev-banner {
            background: rgba(143, 188, 143, 0.03);
            border: 1px dashed rgba(143, 188, 143, 0.3);
            padding: 15px;
            border-radius: 12px;
            margin-bottom: 20px;
            display: flex;
            align-items: center;
            gap: 15px;
        }
        .dev-icon { width: 24px; height: 24px; fill: var(--accent); animation: spin 8s linear infinite; flex-shrink: 0; }
        @keyframes spin { from { transform: rotate(0deg); } to { transform: rotate(360deg); } }
        .dev-badge { background: var(--accent); color: #000; font-size: 0.6rem; font-weight: 900; padding: 2px 6px; border-radius: 4px; text-transform: uppercase; }
        .dev-text { font-size: 0.75rem; color: rgba(255,255,255,0.6); margin: 0; }
        .dev-text b { color: var(--accent); }

        /* Filtros */
        .filters-area { display: flex; gap: 10px; margin-bottom: 20px; flex-wrap: wrap; background: #1a1a1a; padding: 15px; border-radius: 8px; border: 1px solid #333; }
        .filter-group { flex: 1; min-width: 140px; }
        .filter-group label { display: block; color: var(--accent); font-size: 0.65rem; font-weight: bold; margin-bottom: 5px; text-transform: uppercase; }
        .filter-group select { width: 100%; padding: 8px; background: #000; border: 1px solid #444; color: #fff; border-radius: 4px; font-size: 0.85rem; outline: none; }

        /* Tabla */
        table.dataTable { width: 100% !important; margin-top: 15px !important; }
        table.dataTable thead th { color: var(--accent) !important; border-bottom: 1px solid #444 !important; text-transform: uppercase; font-size: 0.65rem; padding: 12px 8px !important; background: #0a0a0a; }
        table.dataTable tbody td { border-bottom: 1px solid #222 !important; font-size: 0.85rem; color: #ddd; padding: 10px 8px !important; }
        
        /* Badges de Posición */
        .rank-badge { font-weight: 800; color: #fff; background: #333; padding: 2px 6px; border-radius: 4px; font-size: 0.8rem; display: inline-block; min-width: 25px; text-align: center; }
        .rank-gen { background: var(--accent); color: #000; }
        .rank-podium { border: 1px solid var(--accent); color: var(--accent); background: transparent; }
    </style>
</head>
<body>

    <div class="container">
        <header>
            <a href="../../index.html" class="logo">Jotappe</a>
            <a href="../../resultados.html" class="back-btn">← Volver</a>
        </header>

        <div class="dev-banner">
            <svg class="dev-icon" viewBox="0 0 24 24"><path d="M12,15.5A3.5,3.5 0 0,1 8.5,12A3.5,3.5 0 0,1 12,8.5A3.5,3.5 0 0,1 15.5,12A3.5,3.5 0 0,1 12,15.5M19.43,12.97C19.47,12.65 19.5,12.33 19.5,12C19.5,11.67 19.47,11.34 19.43,11L21.54,9.37C21.73,9.22 21.78,8.95 21.66,8.73L19.66,5.27C19.54,5.05 19.27,4.96 19.05,5.05L16.56,6.05C16.04,5.66 15.47,5.32 14.87,5.07L14.49,2.42C14.46,2.18 14.25,2 14,2H10C9.75,2 9.54,2.18 9.51,2.42L9.13,5.07C8.53,5.32 7.96,5.66 7.44,6.05L4.95,5.05C4.73,4.96 4.46,5.05 4.34,5.27L2.34,8.73C2.21,8.95 2.27,9.22 2.46,9.37L4.57,11C4.53,11.34 4.5,11.67 4.5,12C4.5,11.67 4.53,11.34 4.57,11L2.46,9.37C2.27,9.22 2.21,8.95 2.34,8.73L4.34,5.27C4.46,5.05 4.73,4.96 4.95,5.05L7.44,6.05C7.96,5.66 8.53,5.32 9.13,5.07L9.51,2.42C9.54,2.18 9.75,2 10,2H14C14.25,2 14.46,2.18 14.49,2.42L14.87,5.07C15.47,5.32 16.04,5.66 16.56,6.05L19.05,5.05C19.27,4.96 19.54,5.05 19.66,5.27L21.66,8.73C21.78,8.95 21.73,9.22 21.54,9.37L19.43,11C19.47,11.34 19.5,11.67 19.5,12C19.5,12.33 19.47,12.65 19.43,12.97Z" /></svg>
            <div class="dev-content">
                <div class="dev-badge">v1.0 Alpha</div>
                <p class="dev-text"><b>SISTEMA EN EVOLUCIÓN:</b> Optimizando lógica de <i>discernimiento</i> de categorías.</p>
            </div>
        </div>

        <span class="subtitle">Clasificación Oficial // Cochrane Patagonia Trail 2025</span>
        <h1>Cochrane Patagonia Trail 2025</h1>

        <div class="filters-area">
            <div class="filter-group">
                <label>Distancia</label>
                <select id="filtroDistancia"><option value="">Todas</option></select>
            </div>
            <div class="filter-group">
                <label>Sexo</label>
                <select id="filtroSexo">
                    <option value="">Todos</option>
                    <option value="M">Masculino</option>
                    <option value="F">Femenino</option>
                </select>
            </div>
            <div class="filter-group">
                <label>Categoría</label>
                <select id="filtroCategoria" disabled><option value="">Elegir distancia...</option></select>
            </div>
        </div>

        <table id="tablaResultados" class="display responsive nowrap" style="width:100%">
            <thead>
                <tr>
                    <th>Gral</th>
                    <th>Sexo</th>
                    <th>Cat Pos</th>
                    <th>Bib</th>
                    <th>Nombre</th>
                    <th>Dist</th>
                    <th>Categoría</th>
                    <th>Tiempo</th>
                </tr>
            </thead>
            <tbody></tbody>
        </table>
    </div>

    <script src="https://code.jquery.com/jquery-3.7.0.min.js"></script>
    <script src="https://cdn.datatables.net/1.13.6/js/jquery.dataTables.min.js"></script>
    <script src="https://cdn.datatables.net/responsive/2.5.0/js/dataTables.responsive.min.js"></script>

    <script>
        // BASE DE DATOS REINTEGRADA
        const rawData = [
            ["1","54","Leonardo Macaya","17K","50 a 59","1:36:34.5"],["2","31","Luis Ferrero","17K","50 a 59","1:42:08.4"],["3","1","Hugo Aceituno Pinto","17K","30 a 39","1:45:17.9"],["4","121","Benjamin Silva","17K","18 a 29","1:51:15.0"],["5","61","Gustavo Martinez Valdivia","17K","30 a 39","1:52:38.5"],["6","93","Franco Roque Sanz","17K","40 a 49","1:52:53.7"],["7","83","Luis Felipe Pozo Valenzuela","17K","18 a 29","1:53:19.4"],["8","29","Sebastian Escalona Quiero","17K","30 a 39","1:53:59.2"],["9","115","Marco Formantel","17K","30 a 39","1:54:27.2"],["10","91","Hugo Sandoval Álvarez","17K","30 a 39","2:00:31.7"],["11","77","Fabian Parada","17K","30 a 39","2:00:33.0"],["12","20","Delia Cardenas","17K","30 a 39 F","2:00:41.0"],["13","94","Dominique Schnitzer","17K","18 a 29 F","2:01:33.0"],["14","58","Francisco Maripillán Torres","17K","30 a 39","2:02:31.5"],["15","129","Javier Diaz","17K","40 a 49","2:07:29.0"],["16","12","Carlos Patricio Ballesteros Fonseca","17K","40 a 49","2:08:02.1"],["17","8","Pablo Araya Gajardo","17K","18 a 29","2:08:45.3"],["18","75","Claudio Olivarez","17K","30 a 39","2:12:47.8"],["19","74","Fabiola Olivares Rial","17K","30 a 39 F","2:13:50.2"],["20","84","Sergio Quintana","17K","50 a 59","2:15:31.4"],["21","118","Cristobal Fernandois","17K","18 a 29","2:16:15.2"],["22","122","Alvaro Jofre","17K","18 a 29","2:16:34.0"],["23","37","Pablo García Palacios","17K","30 a 39","2:16:38.3"],["24","48","Javier Lenciza","17K","50 a 59","2:17:10.3"],["25","69","Paola Nava Velasquez","17K","18 a 29 F","2:17:12.2"],["26","38","Soledad Geisse Geisse","17K","40 a 49 F","2:17:24.3"],["27","9","Eduardo Aros","17K","30 a 39","2:18:13.9"],["28","128","Rodrigo Aburto Bustamante","17K","30 a 39","2:18:18.9"],["29","71","Consuelo Nuñez","17K","18 a 29 F","2:18:23.8"],["30","103","Tomás Valenzuela Núñez","17K","30 a 39","2:18:55.5"],["31","109","Ramón Vidal Vidal","17K","40 a 49","2:19:01.9"],["32","87","Nora Patricia Ruiz Fernandez","17K","30 a 39 F","2:19:08.8"],["33","36","Yara Gallardo Pizarro","17K","18 a 29 F","2:19:52.7"],["34","120","Francisco Caceres","17K","30 a 39","2:20:09.9"],["35","100","Gabriel Torres Pineda","17K","40 a 49","2:21:43.6"],["36","127","Felix Tiyan","17K","18 a 29","2:21:48.8"],["37","21","Isamar Cárdenas Arratia","17K","18 a 29 F","2:22:16.2"],["38","65","Magdalena Montero","17K","50 a 59 F","2:24:32.7"],["39","123","Eduardo Velasquez Muñoz","17K","50 a 59","2:25:30.2"],["40","68","David Muñoz","17K","18 a 29","2:25:43.6"],["41","73","Lorena Olivares Rial","17K","40 a 49 F","2:25:45.1"],["42","45","Marcos Jimenez Carrasco","17K","50 a 59","2:26:12.3"],["43","106","Vanessa Catalina Vásquez Leal","17K","30 a 39 F","2:26:22.4"],["44","28","Trinidad Donoso","17K","18 a 29 F","2:27:04.8"],["45","60","Marta Isabel Martínez Paredes","17K","50 a 59 F","2:28:04.9"],["46","70","Ignacio Navarrete","17K","30 a 39","2:29:28.2"],["47","66","Lorena Mora Castro","17K","30 a 39 F","2:29:36.5"],["48","80","Gonzalo Peña Navarro","17K","30 a 39","2:31:04.4"],["49","26","Carolina Del Rio","17K","40 a 49 F","2:31:24.6"],["50","101","Bárbara Ulloa Oyarzún","17K","30 a 39 F","2:32:31.1"],["51","125","Javiera Muñoz","17K","18 a 29 F","2:32:33.0"],["52","119","Maximiliano Aguirre","17K","30 a 39","2:33:16.0"],["53","85","Engela Rojas Medina","17K","30 a 39 F","2:34:48.3"],["54","117","Dina Casanova Paredes","17K","50 a 59 F","2:35:00.6"],["55","51","Saul Luengo Monsalves","17K","30 a 39","2:37:09.8"],["56","40","Valeria Herrera","17K","40 a 49 F","2:38:05.8"],["57","13","Claudia Berrios","17K","40 a 49 F","2:38:46.7"],["58","18","Iván Cabrera Pavez","17K","60 a 64","2:38:47.4"],["59","107","Rodrigo Vera","17K","40 a 49","2:39:16.2"],["60","97","Rosa Leonor Soria","17K","50 a 59 F","2:39:53.8"],["61","59","Mariana Martínez","17K","18 a 29 F","2:40:26.0"],["62","10","María Eugenia Aruanno","17K","30 a 39 F","2:41:05.1"],["63","11","Fernanda Azocar","17K","40 a 49 F","2:41:16.7"],["64","24","Paulina Costas Finkelstein","17K","50 a 59 F","2:43:30.7"],["65","44","Natalia Jardel Soto","17K","30 a 39 F","2:44:09.2"],["66","27","Bárbara Dendal","17K","40 a 49 F","2:44:36.9"],["67","104","María Ignacia Varas Domínguez","17K","18 a 29 F","2:45:42.9"],["68","67","Gabriela Morales Trujillo","17K","40 a 49 F","2:47:09.5"],["69","55","Javiera Manriquez Rocha","17K","18 a 29 F","2:47:10.5"],["70","14","Vanesa Angelica Bórquez Mariao","17K","30 a 39 F","2:47:17.3"],["71","15","Tamara Alejandra Bórquez Mariao","17K","30 a 39 F","2:47:18.1"],["72","79","Cristo Gabriel Pastrana","17K","18 a 29","2:52:55.6"],["73","33","Dannia Fuentes","17K","18 a 29 F","2:53:04.0"],["74","82","María Jesus Portilla Correa","17K","40 a 49 F","2:53:55.7"],["75","124","Silvio Zuñiga","17K","30 a 39","2:57:24.8"],["76","110","Maria Teresa Vidal Aravena","17K","65 y más","2:57:51.7"],["77","114","Yelitza Zambrano","17K","30 a 39 F","2:58:34.4"],["78","53","Luciana Luján","17K","40 a 49 F","2:58:36.9"],["79","34","Carlos Gallardo","17K","30 a 39","2:59:36.1"],["80","63","Claudia Mendoza","17K","30 a 39 F","3:00:01.0"],["81","7","Liliana Paz Aravena Tapia","17K","30 a 39 F","3:03:16.2"],["82","116","María De Los Angeles Fernández Aguirre","17K","40 a 49 F","3:03:48.7"],["83","57","María Pía Marín Marín","17K","60 a 64 F","3:10:43.4"],["84","95","Ana Maria Seguel Beroiza","17K","50 a 59 F","3:13:27.1"],["85","49","Luis Alberto Llaiquel","17K","50 a 59","3:15:44.2"],["86","23","Noelia Belen Castillo Pino","17K","18 a 29 F","3:23:32.6"],["87","17","Marisol Bustos Hettich","17K","60 a 64 F","3:24:59.8"],["88","102","Alicia Uribe","17K","50 a 59 F","3:25:08.0"],["89","62","Fabiana Melian","17K","50 a 59 F","3:47:28.3"],["90","6","Maria Angelica Antiñanco Levicoy","17K","40 a 49 F","4:13:11.1"],["91","239","Eugenio Parra","35K","40 a 49","3:56:30.7"],["92","224","Gustavo Jara","35K","30 a 39","4:25:31.1"],["93","200","Cristian Aguilar","35K","30 a 39","4:37:19.7"],["94","253","Nicolas Valdivieso","35K","40 a 49","4:37:36.0"],["95","213","Pilar Corvalán","35K","30 a 39 F","4:39:35.9"],["96","229","Felipe Montero Brunner","35K","50 a 59","4:53:09.3"],["97","216","Cristian Díaz Guzmán","35K","18 a 29","4:54:13.4"],["98","206","Ivan Silva","35K","30 a 39","4:57:19.6"],["99","261","Maxine Ritter Van De Kamp","35K","18 a 29 F","5:15:33.8"],["100","264","Botros Toro","35K","30 a 39","5:17:50.3"],["101","259","Lorena Villalobos","35K","30 a 39 F","5:25:49.7"],["102","209","Karina Carcamo","35K","30 a 39 F","5:26:34.8"],["103","214","Natalia De Rays Reyes","35K","18 a 29 F","5:27:32.8"],["104","223","Icsen Jara","35K","50 a 59 F","5:31:31.7"],["105","263","Camila Martens","35K","30 a 39 F","5:36:00.7"],["106","245","Mauricio Rojas Molina","35K","30 a 39","5:39:04.9"],["107","257","Rafael Vargas","35K","50 a 59","5:39:24.7"],["108","208","Francisca Campos","35K","18 a 29 F","5:42:11.7"],["109","243","Paola Rial","35K","40 a 49 F","5:48:51.6"],["110","234","Anibal Ocampos Sandoval","35K","30 a 39","5:52:38.4"],["111","233","Silvana Gabriela Nazer Tabares","35K","40 a 49 F","6:06:47.2"],["112","249","Maria Saumont","35K","40 a 49 F","6:14:36.1"],["113","252","Cristian Ulloa Barria","35K","40 a 49","6:20:16.6"],["114","227","Mirta Martinez","35K","40 a 49 F","6:20:34.9"],["115","211","Denisse Catricura","35K","30 a 39 F","6:26:04.6"],["116","236","Teresita Ortiz Arellano","35K","18 a 29 F","6:32:32.9"],["117","203","Hector Barriga Catelican","35K","40 a 49","6:38:26.8"],["118","221","Alfredo Guinea","35K","50 a 59","6:39:21.3"],["119","248","Daiana Sanchez","35K","30 a 39 F","6:47:21.6"],["120","228","Roberto Mercado","35K","40 a 49 F","6:51:39.9"],["121","205","Migle Bobinaite","35K","30 a 39 F","6:54:44.6"],["122","204","Lucas Besasso Rodríguez","35K","30 a 39","6:58:59.8"],["123","238","Joaquin Parisi","35K","18 a 29","6:59:00.2"],["124","254","Pia Varela","35K","40 a 49 F","7:03:16.6"],["125","260","Elizabeth Walter","35K","30 a 39","7:19:12.1"],["126","207","Jorge Bustamante Moreira","35K","50 a 59","7:22:44.2"],["127","202","Anya Correa","35K","40 a 49 F","7:59:11.8"],["128","225","Margareth Aniuska Moraga Llaitureo","35K","40 a 49 F","8:13:20.8"],["129","406","Cesar Adolfo Sanhueza","45K","30 a 39","6:15:39.1"],["130","423","Ruperto Mansilla","45K","40 a 49","6:41:40.4"],["131","426","Andres Silva","45K","30 a 39","6:44:03.9"],["132","413","Juan Manuel Gonzalez","45K","18 a 29","6:58:12.5"],["133","415","Rodrigo Hermosilla","45K","30 a 39","7:02:45.3"],["134","430","Marcelo Soto","45K","40 a 49","7:08:21.2"],["135","429","Cristian Solis","45K","30 a 39","7:14:55.7"],["136","414","Patricio Gutierrez","45K","50 a 59","7:35:10.1"],["137","408","Miguel Angel Cisterna","45K","40 a 49","7:38:22.9"],["138","431","Alejandro Valdebenito","45K","30 a 39","7:45:01.8"],["139","422","Ricardo Maldonado","45K","40 a 49","8:12:33.4"],["140","412","Diego Gajardo","45K","18 a 29","8:25:10.5"],["141","417","Jorge Jara","45K","50 a 59","8:32:45.9"],["142","432","Claudio Vera","45K","40 a 49","8:41:59.6"],["143","421","Pablo López","45K","40 a 49","8:45:12.3"],["144","409","Felipe Contreras","45K","30 a 39","9:02:15.1"],["145","401","Macarena Albornoz","45K","30 a 39 F","9:18:22.8"],["146","411","Francisco Fuentes","45K","30 a 39","9:25:34.2"],["147","402","Romina Alvarez","45K","30 a 39 F","9:32:15.7"],["148","427","Daniel Silva","45K","30 a 39","9:45:22.3"],["149","337","Stefhano Calderon","45K","30 a 39","4:07:51.7"],["150","336","Yonathan Vargas Espinoza","45K","18 a 29","4:26:04.1"],["151","330","Marco Rojas Olivared","45K","30 a 39","4:44:26.5"],["152","334","Cristóbal Troncoso Acosta","45K","18 a 29","4:51:52.3"],["153","325","Bastian Pardo","45K","18 a 29","4:57:27.6"],["154","305","Felix Javier Castillo Román","45K","18 a 29","5:19:25.3"],["155","316","Alonso Herrera","45K","30 a 39","5:21:41.0"],["156","310","Andres Delgado","45K","30 a 39","5:48:53.2"],["157","308","Gabriel Adolfo Curguan Catalan","45K","30 a 39","5:51:36.7"],["158","311","Federico Djeordjian","45K","40 a 49","5:59:31.2"],["159","313","Mauricio Ferrada","45K","50 a 59","6:13:42.7"],["160","329","Denisse Sella","45K","40 a 49 F","6:39:50.8"],["161","312","Ingrid Espinoza","45K","50 a 59 F","6:49:51.9"],["162","322","Marcia Miranda Escala","45K","30 a 39 F","6:50:46.4"],["163","317","Tanya Jimenez","45K","40 a 49 F","7:01:59.2"],["164","306","Cristóbal Chible Aburto","45K","40 a 49","7:07:43.2"],["165","309","Sergio De Amesti","45K","40 a 49","7:07:44.1"],["166","335","Hugo Urrutia","45K","50 a 59","7:15:53.3"],["167","304","Nelson Eduardo Cardenas","45K","50 a 59","7:15:55.0"],["168","300","Diana Aceituno","45K","30 a 39 F","7:19:44.0"],["169","303","Juan Antonio Bahamonde Aguila","45K","65 y más","7:42:27.2"],["170","323","Claudio Molina","45K","40 a 49","8:36:49.5"],["171","314","Jorge Flores Vargas","45K","50 a 59","8:36:50.6"],["172","539","Antonio Rojas","8K","FAMILIAR","32:10.9"],["173","537","Aldrin Lagos","8K","FAMILIAR","35:31.5"],["174","510","Javier Andrés Martinez Acosta","8K","FAMILIAR","35:47.7"],["175","538","Juan Jose Cortes","8K","FAMILIAR","35:52.7"],["176","531","Vicente Cossio","8K","FAMILIAR","39:31.9"],["177","500","Antonia Bahamonde","8K","FAMILIAR F","40:13.2"],["178","534","Gonzalo Garces","8K","FAMILIAR","41:23.0"],["179","527","Paz Francisca Gatica","8K","FAMILIAR F","42:11.4"],["180","507","Manuel Jara","8K","FAMILIAR","42:13.9"],["181","515","Nicolas Oporto","8K","FAMILIAR","43:36.0"],["182","519","Gabriela Ant Pérez Muñoz","8K","FAMILIAR F","44:42.8"],["183","530","Macarena Herrera","8K","FAMILIAR F","45:12.5"],["184","514","Lucas Ocampo","8K","FAMILIAR","45:39.4"],["185","517","Renzo Ordenes","8K","FAMILIAR","46:22.7"],["186","540","Vanessa García Paillán","8K","FAMILIAR F","50:01.0"],["187","506","Jorge Hinojosa Castillo","8K","FAMILIAR","51:33.9"],["188","518","Karem Ortúzar Moreno","8K","FAMILIAR F","51:36.5"],["189","520","Rodrigo Rivera","8K","FAMILIAR","52:16.4"],["190","509","Fabiola Luna Arratia","8K","FAMILIAR F","52:25.2"],["191","502","Luciano Castillo Vasquez","8K","FAMILIAR","52:27.0"],["192","525","Paola Andrea Zambrano Maldonado","8K","FAMILIAR F","53:34.3"],["193","533","Renato Muñoz","8K","FAMILIAR","53:48.3"],["194","535","Pablo Gelardi","8K","FAMILIAR","54:30.4"],["195","528","Laura Troncoso","8K","FAMILIAR F","54:54.7"],["196","504","Danisa Cutipa","8K","FAMILIAR F","55:18.5"],["197","522","Paulina Andrea Soto Soto","8K","FAMILIAR F","1:01:44.0"],["198","526","Manuel Melinao Soto","8K","FAMILIAR","1:01:45.0"],["199","536","Isabel Burgos","8K","FAMILIAR F","1:04:05.6"],["200","532","Ramon Lujan","8K","FAMILIAR","1:04:05.8"],["201","529","Maria Paz Parra","8K","FAMILIAR F","1:12:48.3"],["202","508","Paci Lizama","8K","FAMILIAR F","1:12:49.5"]
        ];

        $(document).ready(function() {
            // PROCESAMIENTO INICIAL
            let processedData = rawData.map(row => {
                let cat = row[4];
                let sexo = (cat.endsWith(' F') || cat.includes('FAMILIAR F')) ? 'F' : 'M';
                return {
                    bib: row[1], nombre: row[2], dist: row[3], tiempo: row[5],
                    sexo: sexo, originalCat: row[4]
                };
            });

            // Rankings por distancia
            let distancias = [...new Set(processedData.map(r => r.dist))];
            distancias.forEach(dist => {
                let dGroup = processedData.filter(r => r.dist === dist);
                dGroup.sort((a, b) => a.tiempo.localeCompare(b.tiempo));
                dGroup.forEach((r, i) => r.posGral = i + 1);

                ['M', 'F'].forEach(s => {
                    let sGroup = dGroup.filter(r => r.sexo === s);
                    sGroup.forEach((r, i) => {
                        r.posSexo = i + 1;
                        r.isElite = (r.posSexo <= 3);
                        r.catLabel = r.isElite ? "GENERAL" : r.originalCat;
                        r.posCatFinal = r.isElite ? "—" : null;
                    });
                });

                let uniqueCats = [...new Set(dGroup.map(r => r.originalCat))];
                uniqueCats.forEach(c => {
                    let cGroup = dGroup.filter(r => r.originalCat === c && !r.isElite);
                    cGroup.forEach((r, i) => r.posCatFinal = i + 1);
                });
            });

            // DATATABLES
            var table = $('#tablaResultados').DataTable({
                data: processedData,
                columns: [
                    { data: 'posGral', render: d => `<span class="rank-badge rank-gen">${d}</span>` },
                    { data: null, render: d => `<span class="rank-badge">${d.posSexo}${d.sexo}</span>` },
                    { data: 'posCatFinal', render: d => `<span class="rank-badge ${d === 1 ? 'rank-podium' : ''}">${d}</span>` },
                    { data: 'bib' },
                    { data: 'nombre' },
                    { data: 'dist', render: d => `<b style="color:var(--accent)">${d}</b>` },
                    { data: 'catLabel', render: d => d === "GENERAL" ? `<i style="color:var(--accent)">${d}</i>` : d },
                    { data: 'tiempo', className: "dt-body-right" }
                ],
                order: [[0, 'asc']],
                language: { search: "Buscar:", lengthMenu: "Ver _MENU_", info: "Mostrando _TOTAL_ corredores" },
                responsive: true,
                pageLength: 25,
                initComplete: function () {
                    distancias.sort().forEach(d => $('#filtroDistancia').append(`<option value="${d}">${d}</option>`));
                }
            });

            // LÓGICA DE FILTROS EN CASCADA (DISTANCIA + SEXO)
            function actualizarFiltros() {
                let dist = $('#filtroDistancia').val();
                let sexo = $('#filtroSexo').val();
                let catSelect = $('#filtroCategoria');

                // Aplicar filtros a tabla
                table.column(5).search(dist ? '^' + dist + '$' : '', true, false);
                table.draw();

                // Actualizar menú de categorías
                catSelect.empty().append('<option value="">Todas las categorías</option>');
                if (!dist) {
                    catSelect.prop('disabled', true).append('<option value="">Elegir distancia...</option>');
                } else {
                    catSelect.prop('disabled', false);
                    let catsDisponibles = processedData.filter(r => {
                        let matchDist = r.dist === dist;
                        let matchSexo = !sexo || r.sexo === sexo;
                        return matchDist && matchSexo;
                    }).map(r => r.catLabel);

                    [...new Set(catsDisponibles)].sort().forEach(c => {
                        catSelect.append(`<option value="${c}">${c}</option>`);
                    });
                }
                table.column(6).search('').draw();
            }

            $('#filtroDistancia, #filtroSexo').on('change', actualizarFiltros);
            $('#filtroCategoria').on('change', function () {
                let val = $(this).val();
                table.column(6).search(val ? '^' + val + '$' : '', true, false).draw();
            });

            // Filtro Global de Sexo
            $.fn.dataTable.ext.search.push(function(settings, data, dataIndex) {
                let s = $('#filtroSexo').val();
                return !s || processedData[dataIndex].sexo === s;
            });
        });
    </script>
</body>
</html>
